/*
   功能：武林JavaScript库
   作者：李林
   时间：2010-06-01
   网站：http://www.webdm.cn/
*/
(function() { window['WLJS'] = {}; function $(id) { return document.getElementById(id); } window['WLJS']['$'] = $; function getElementsByClassName(className, tag) { var _allTags = document.getElementsByTagName(tag); var _matchingElements = new Array(); className = className.replace(/\-/g, "\\-"); var _regex = new RegExp("(^|\\s)" + className + "(\\s|$)"); var _element; for (var i = 0; i < _allTags.length; i++) { _element = _allTags[i]; if (_regex.test(_element.className)) { _matchingElements.push(_element); } } return _matchingElements; } window['WLJS']['getElementsByClassName'] = getElementsByClassName; function Ltrim(str) { if (str.length == 0) return (str); else { var idx = 0; while (str.charAt(idx).search(/\s/) == 0) idx++; return (str.substr(idx)); } } window['WLJS']['Ltrim'] = Ltrim; function Rtrim(str) { if (str.length == 0) return (str); else { var idx = str.length - 1; while (str.charAt(idx).search(/\s/) == 0) idx--; return (str.substring(0, idx + 1)); } } window['WLJS']['Rtrim'] = Rtrim; function Trim(str) { return (WLJS.Rtrim(WLJS.Ltrim(str))); } window['WLJS']['Trim'] = Trim; function removeAllSpace(str) { var localString = ''; for (var index = 0; index < str.length; index++) if (str.charCodeAt(index) != 32) { localString += str.charAt(index); }; return localString; } window['WLJS']['removeAllSpace'] = removeAllSpace; function IsNullById(id) { var _temp = getVal(id); if (_temp.length == 0 || _temp == "") { return true; } else { return false; } } window['WLJS']['IsNullById'] = IsNullById; function getVal(id) { return removeAllSpace($(id).value); } window['WLJS']['getVal'] = getVal; function IsTelByStr(_str) { var _regex0 = /^(([0\+]\d{2,3}-)?(0\d{2,3})-)?(\d{7,8})(-(\d{3,}))?$/; var _regex1 = /^((\(\d{2,3}\))|(\d{3}\-))?(13|15|18)\d{9}$/; if ((TestRgexp(_regex0, _str)) || (TestRgexp(_regex1, _str))) { return true; } else { return false; } } window['WLJS']['IsTelByStr'] = IsTelByStr; function IsEmailByStr(_str) { var _regex = /^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/; if (TestRgexp(_regex, _str)) { return true; } else { return false; } } window['WLJS']['IsEmailByStr'] = IsEmailByStr; function IsNumByStr(_str) { var _regex = /^\d*$/; if (TestRgexp(_regex, _str)) { return true; } else { return false; } } window['WLJS']['IsNumByStr'] = IsNumByStr; function IsDateTimeByStr(_str) { var _regex = /^(\d{4})-(\d{2})-(\d{2})$/; if (TestRgexp(_regex, _str)) { return true; } else { return false; } } window['WLJS']['IsDateTimeByStr'] = IsDateTimeByStr; function AJAX(sUrl, fFunc, sQuery) { this.URL = sUrl; this.Func = fFunc; this.Query = sQuery; this.XMLHttp = this.createXMLHttpRequest(); if (this.XMLHttp == null) { alert("不能创建AJAX实例！"); return; } var objXMLHttp = this.XMLHttp; objXMLHttp.onreadystatechange = function() { AJAX.handleStateChange(objXMLHttp, fFunc); }; } AJAX.prototype.createXMLHttpRequest = function() { try { return new ActiveXObject("Msxml2.XMLHTTP"); } catch (e) { try { return new ActiveXObject("Microsoft.XMLHTTP"); } catch (ex) { return new XMLHttpRequest(); } } return null; }; AJAX.prototype.GetMethod = function() { this.XMLHttp.open("GET", this.URL, true); this.XMLHttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded;charset=UTF-8"); this.XMLHttp.send(null); }; AJAX.prototype.PostMethod = function() { this.XMLHttp.open("POST", this.URL, true); this.XMLHttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded;charset=UTF-8"); this.XMLHttp.send(this.Query); }; AJAX.handleStateChange = function(xmlhttp, fFunc) { if (xmlhttp.readyState == 4) { if (xmlhttp.status == 200) { fFunc(xmlhttp.responseText); } else { alert("您所请求的页面有异常。服务器返回代码:" + xmlhttp.status); } } }; window['WLJS']['AJAX'] = AJAX; function Alert(title, msg, w, h) { var titleheight = "22px"; var bordercolor = "#3086c6"; var titlecolor = "#FFFFFF"; var titlebgcolor = "#3086c6"; var bgcolor = "#FFFFFF"; var iWidth = document.documentElement.clientWidth; var iHeight = document.documentElement.clientHeight; var bgObj = document.createElement("div"); bgObj.style.cssText = "position:absolute;left:0px;top:0px;width:" + iWidth + "px;height:" + Math.max(document.body.clientHeight, iHeight) + "px;filter:Alpha(Opacity=30);opacity:0.3;background-color:#000000;z-index:101;"; document.body.appendChild(bgObj); var msgObj = document.createElement("div"); msgObj.style.cssText = "position:absolute;font:11px '宋体';top:" + (iHeight - h) / 2 + "px;left:" + (iWidth - w) / 2 + "px;width:" + w + "px;height:" + h + "px;text-align:center;border:1px solid " + bordercolor + ";background-color:" + bgcolor + ";padding:1px;line-height:22px;z-index:102;"; document.body.appendChild(msgObj); var table = document.createElement("table"); msgObj.appendChild(table); table.style.cssText = "margin:0px;border:0px;padding:0px;"; table.cellSpacing = 0; var tr = table.insertRow(-1); var titleBar = tr.insertCell(-1); titleBar.style.cssText = "width:100%;height:" + titleheight + "px;text-align:left;padding:3px;margin:0px;font:bold 13px '宋体';color:" + titlecolor + ";border:1px solid " + bordercolor + ";cursor:move;background-color:" + titlebgcolor; titleBar.style.paddingLeft = "10px"; titleBar.innerHTML = title; var moveX = 0; var moveY = 0; var moveTop = 0; var moveLeft = 0; var moveable = false; var docMouseMoveEvent = document.onmousemove; var docMouseUpEvent = document.onmouseup; titleBar.onmousedown = function() { var evt = WLJS.getEvent(); moveable = true; moveX = evt.clientX; moveY = evt.clientY; moveTop = parseInt(msgObj.style.top); moveLeft = parseInt(msgObj.style.left); document.onmousemove = function() { if (moveable) { var evt = WLJS.getEvent(); var x = moveLeft + evt.clientX - moveX; var y = moveTop + evt.clientY - moveY; if (x > 0 && (x + w < iWidth) && y > 0 && (y + h < iHeight)) { msgObj.style.left = x + "px"; msgObj.style.top = y + "px"; } } }; document.onmouseup = function() { if (moveable) { document.onmousemove = docMouseMoveEvent; document.onmouseup = docMouseUpEvent; moveable = false; moveX = 0; moveY = 0; moveTop = 0; moveLeft = 0; } }; }; var closeBtn = tr.insertCell(-1); closeBtn.style.cssText = "cursor:pointer; padding:2px;background-color:" + titlebgcolor; closeBtn.innerHTML = "<span style='font-size:15pt; color:" + titlecolor + ";'>×</span>"; closeBtn.onclick = function() { document.body.removeChild(bgObj); document.body.removeChild(msgObj); }; var msgBox = table.insertRow(-1).insertCell(-1); msgBox.style.cssText = "font:14px '宋体';padding:20px 0 0 20px;text-align:left;"; msgBox.colSpan = 2; msgBox.innerHTML = msg; var msgBtn = table.insertRow(-1).insertCell(-1); msgBtn.style.cssText = "text-align:right;padding:15px 0 0 8px;"; msgBtn.innerHTML = "<input type='button' style='font-family:Arial, Helvetica, sans-serif;line-height:1.5;font-size:14px;font-weight:500;padding:3px 10px;*padding:1px 4px;cursor:pointer;' onclick='javascript:void(0);' value='确 定' />"; msgBtn.onclick = function() { document.body.removeChild(bgObj); document.body.removeChild(msgObj); } } window['WLJS']['Alert'] = Alert; function getEvent() { return window.event || arguments.callee.caller.arguments[0]; } window['WLJS']['getEvent'] = getEvent; function TestRgexp(re, s) { return re.test(s); } window['WLJS']['TestRgexp'] = TestRgexp; function GetQueryString(_name) { var reg = new RegExp("(^|&)" + _name + "=([^&]*)(&|$)"); var r = window.location.search.substr(1).match(reg); if (r != null) return unescape(r[2]); return null; } window['WLJS']['GetQueryString'] = GetQueryString; })();

